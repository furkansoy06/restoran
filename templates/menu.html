<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ÅimÅŸek Aspava - Dijital MenÃ¼</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body { background-color: #f4f7f6; font-family: 'Segoe UI', sans-serif; padding-bottom: 150px; scroll-behavior: smooth; }
        .header { background: linear-gradient(135deg, #ce1212 0%, #8b0000 100%); color: white; padding: 30px 15px; text-align: center; border-radius: 0 0 25px 25px; box-shadow: 0 4px 15px rgba(0,0,0,0.2); }
        .nav-scroller { position: sticky; top: 0; z-index: 1000; background: rgba(255,255,255,0.95); backdrop-filter: blur(10px); box-shadow: 0 2px 10px rgba(0,0,0,0.05); overflow-x: auto; white-space: nowrap; padding: 12px; }
        .nav-item { display: inline-block; background: #eee; color: #444; padding: 8px 18px; border-radius: 25px; margin-right: 8px; text-decoration: none; font-size: 13px; font-weight: 700; transition: 0.3s; }
        .nav-item:active { background: #ce1212; color: white; }
        
        .menu-card { background: white; border-radius: 18px; margin-bottom: 15px; display: flex; align-items: center; box-shadow: 0 4px 12px rgba(0,0,0,0.04); border: 1px solid #eee; transition: 0.3s; overflow: hidden; }
        .menu-card:hover { transform: translateY(-3px); box-shadow: 0 6px 18px rgba(0,0,0,0.08); }
        .menu-img { width: 95px; height: 95px; object-fit: cover; border-radius: 12px; margin: 12px; }
        .menu-info { flex: 1; padding: 10px 5px; }
        .price-tag { color: #ce1212; font-weight: 800; font-size: 1.1rem; display: block; margin-top: 5px; }
        
        .order-bar { position: fixed; bottom: 0; left: 0; right: 0; background: white; padding: 20px; box-shadow: 0 -10px 25px rgba(0,0,0,0.1); border-radius: 25px 25px 0 0; display: none; z-index: 2000; }
        .btn-whatsapp { background: #25D366; color: white; font-weight: 800; border-radius: 15px; border: none; padding: 15px; width: 100%; font-size: 1.1rem; box-shadow: 0 4px 12px rgba(37, 211, 102, 0.3); }
        .category-title { color: #333; font-weight: 800; margin: 25px 0 15px; padding-left: 10px; border-left: 5px solid #ce1212; }
        .search-container { margin-top: -25px; }
        .search-input { border-radius: 15px; border: none; padding: 12px 20px; box-shadow: 0 4px 12px rgba(0,0,0,0.1); }
    </style>
</head>
<body>

    <div class="header">
        <h1 class="fw-bold">âš¡ ÅÄ°MÅEK ASPAVA</h1>
        <p class="opacity-75">Lezzetin Tek Adresi</p>
    </div>

    <div class="container search-container">
        <div class="row g-2">
            <div class="col-8">
                <input type="text" id="searchInput" class="form-control search-input" placeholder="ğŸ” Yemek ara..." onkeyup="aramaYap()">
            </div>
            <div class="col-4">
                <select id="masaNo" class="form-select search-input fw-bold text-danger">
                    <option value="Belirtilmedi">Masa?</option>
                    <option value="Masa 1">M 1</option>
                    <option value="Masa 2">M 2</option>
                    <option value="Masa 3">M 3</option>
                    <option value="Masa 4">M 4</option>
                    <option value="Masa 5">M 5</option>
                    <option value="Paket">Paket</option>
                </select>
            </div>
        </div>
    </div>

    <div class="nav-scroller mt-3">
        {% for grup in menu %}
            <a href="#{{ grup.id }}" class="nav-item">{{ grup.kategori }}</a>
        {% endfor %}
    </div>

    <div class="container mt-2">
        {% for grup in menu %}
            <h4 id="{{ grup.id }}" class="category-title">{{ grup.kategori }}</h4>
            {% for urun in grup.urunler %}
            <div class="menu-card animate-item">
                <img src="{{ urun.resim }}" class="menu-img" alt="{{ urun.isim }}">
                <div class="menu-info">
                    <h6 class="mb-1 fw-bold">{{ urun.isim }}</h6>
                    <small class="text-muted d-block">{{ urun.detay }}</small>
                    <span class="price-tag">{{ urun.fiyat }}</span>
                </div>
                <button class="btn btn-danger btn-sm me-3 rounded-pill px-3 fw-bold" 
                        onclick="sepeteEkle('{{ urun.isim }}', '{{ urun.fiyat }}')">â• Ekle</button>
            </div>
            {% endfor %}
        {% endfor %}
    </div>

    <div id="orderBar" class="order-bar">
        <div class="d-flex justify-content-between align-items-center mb-3">
            <div>
                <span class="d-block text-muted small">Toplam Tutar:</span>
                <span class="h4 fw-bold text-danger" id="toplamTutar">0 TL</span>
            </div>
            <button class="btn btn-sm btn-light rounded-pill" onclick="sepetiSifirla()">ğŸ§¹ Temizle</button>
        </div>
        <div class="mb-3">
            <input type="text" id="musteriNotu" class="form-control form-control-sm rounded-pill" placeholder="âœï¸ SipariÅŸ notunuz (SoÄŸansÄ±z vb.)">
        </div>
        <button class="btn-whatsapp" onclick="wpSiparisGonder()">ğŸŸ¢ SipariÅŸi WhatsApp'a GÃ¶nder</button>
    </div>

    <script>
        let sepet = [];
        let telefonNumarasi = "905464744594"; // BURAYA NUMARANI YAZ!

        function sepeteEkle(isim, fiyat) {
            // Fiyat bilgisinden sadece sayÄ± kÄ±smÄ±nÄ± al (Ã–rn: "320 TL" -> 320)
            let sayisalFiyat = parseInt(fiyat.replace(/[^0-9]/g, ''));
            sepet.push({isim, fiyat: sayisalFiyat});
            
            guncelleArayuz();
        }

        function guncelleArayuz() {
            let bar = document.getElementById('orderBar');
            if(sepet.length > 0) {
                bar.style.display = 'block';
                let toplam = sepet.reduce((acc, curr) => acc + curr.fiyat, 0);
                document.getElementById('toplamTutar').innerText = toplam + " TL";
            } else {
                bar.style.display = 'none';
            }
        }

        function sepetiSifirla() {
            sepet = [];
            guncelleArayuz();
        }

        function aramaYap() {
            let input = document.getElementById('searchInput').value.toLowerCase();
            let items = document.getElementsByClassName('menu-card');
            for (let item of items) {
                let text = item.querySelector('h6').innerText.toLowerCase();
                item.style.display = text.includes(input) ? "flex" : "none";
            }
        }

        function wpSiparisGonder() {
            let masa = document.getElementById('masaNo').value;
            let not = document.getElementById('musteriNotu').value;
            
            if(masa === "Belirtilmedi") {
                alert("LÃ¼tfen masa numaranÄ±zÄ± seÃ§in!"); return;
            }

            let urunSayilari = {};
            sepet.forEach(x => { urunSayilari[x.isim] = (urunSayilari[x.isim] || 0) + 1; });

            let mesaj = `*âš¡ ÅÄ°MÅEK ASPAVA SÄ°PARÄ°ÅÄ°*\n`;
            mesaj += `â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n`;
            mesaj += `ğŸ“ *KONUM:* ${masa}\n`;
            mesaj += `â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n\n`;
            
            for (let urun in urunSayilari) {
                mesaj += `âœ… ${urunSayilari[urun]} Adet - *${urun}*\n`;
            }
            
            mesaj += `\nâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n`;
            if(not) mesaj += `ğŸ“ *NOT:* ${not}\n`;
            mesaj += `ğŸ’° *TOPLAM:* ${document.getElementById('toplamTutar').innerText}\n`;
            mesaj += `â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n`;
            mesaj += `_SipariÅŸ dijital menÃ¼den gÃ¶nderildi._`;

            window.open(`https://wa.me/${telefonNumarasi}?text=${encodeURIComponent(mesaj)}`, '_blank');
        }
    </script>
</body>
</html>