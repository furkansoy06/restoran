<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‚ö° Furkan Restuarant ULTIMATE MAX</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css"/>
    <style>
        :root { --primary: #ce1212; --dark: #1a1a1a; --success: #25D366; --accent: #ffc107; }
        body { background-color: #f0f2f5; font-family: 'Poppins', sans-serif; padding-bottom: 220px; }
        .header { background: var(--primary); color: white; padding: 40px 20px; border-radius: 0 0 40px 40px; text-align: center; position: relative; overflow: hidden; }
        .menu-card { background: white; border-radius: 20px; margin-bottom: 15px; border: none; transition: 0.4s; position: relative; display: flex; align-items: center; overflow: hidden; }
        .menu-card:hover { transform: scale(1.02); box-shadow: 0 10px 25px rgba(0,0,0,0.1); }
        .menu-img { width: 85px; height: 85px; object-fit: cover; border-radius: 15px; margin: 10px; }
        .filter-btn { border: none; background: white; padding: 8px 15px; border-radius: 20px; font-size: 12px; font-weight: 600; white-space: nowrap; box-shadow: 0 2px 4px rgba(0,0,0,0.05); }
        .filter-btn.active { background: var(--primary); color: white; }
        .order-bar { position: fixed; bottom: 0; left: 0; right: 0; background: white; padding: 20px; box-shadow: 0 -10px 25px rgba(0,0,0,0.15); border-radius: 30px 30px 0 0; z-index: 2000; }
        #suggestionToast { position: fixed; top: 20px; right: 20px; z-index: 3000; display: none; background: white; border-left: 5px solid gold; padding: 15px; border-radius: 10px; box-shadow: 0 5px 15px rgba(0,0,0,0.2); }
    </style>
</head>
<body>

    <div id="suggestionToast" class="animate__animated animate__fadeInRight"><span id="suggestionText"></span></div>

    <div class="header animate__animated animate__fadeInDown">
        <h1 class="fw-bolder">‚ö° Furkan Restuarant <span class="badge bg-white text-danger" style="font-size: 12px;">MAX</span></h1>
        <p class="mb-0">Hƒ±zlƒ±, Sƒ±cak, Akƒ±llƒ± Men√º</p>
    </div>

    <div class="container mt-4">
        <div class="row g-2 mb-3">
            <div class="col-8"><input type="text" id="searchInput" class="form-control rounded-pill border-0 shadow-sm p-3" placeholder="üîç Canƒ±n ne √ßekti?" onkeyup="arama()"></div>
            <div class="col-4">
                <select id="masaNo" class="form-select rounded-pill border-0 shadow-sm p-3 fw-bold text-danger">
                    <option value="Bilinmiyor" selected disabled>üìç Masa?</option>
                    <option value="Masa 1">M 1</option><option value="Masa 2">M 2</option><option value="Masa 3">M 3</option><option value="Paket">Paket</option>
                </select>
            </div>
        </div>

        <div class="d-flex gap-2 overflow-auto pb-3 mb-2" style="scrollbar-width: none;">
            <button class="filter-btn active" onclick="filtrele('hepsi', this)">Hepsi</button>
            {% for grup in menu %}
                <button class="filter-btn" onclick="filtrele('{{ grup.id }}', this)">{{ grup.kategori }}</button>
            {% endfor %}
        </div>

        {% for grup in menu %}
        <div class="category-section" id="cat-{{ grup.id }}">
            <h5 class="fw-bold mt-4 mb-3 border-start border-danger border-4 ps-2">{{ grup.kategori }}</h5>
            {% for urun in grup.urunler %}
            <div class="menu-card" data-name="{{ urun.isim | lower }}">
                <img src="{{ urun.resim }}" class="menu-img">
                <div class="flex-grow-1 ps-2 pe-3">
                    <h6 class="mb-0 fw-bold">{{ urun.isim }}</h6>
                    <small class="text-muted d-block" style="font-size: 0.75rem;">{{ urun.detay }}</small>
                    <div class="d-flex justify-content-between align-items-center mt-1">
                        <span class="text-danger fw-bolder">{{ urun.fiyat }}</span>
                        <button onclick="sepeteEkle('{{ urun.isim }}', '{{ urun.fiyat }}', '{{ urun.oneri }}')" class="btn btn-dark btn-sm rounded-pill px-3">Ekle</button>
                    </div>
                </div>
            </div>
            {% endfor %}
        </div>
        {% endfor %}
    </div>

    <div id="orderBar" class="order-bar animate__animated animate__slideInUp" style="display: none;">
        <input type="text" id="siparisNotu" class="form-control rounded-pill mb-2 border-light shadow-sm" placeholder="üìù Notunuz (Soƒüansƒ±z vb.)">
        <div class="d-flex justify-content-between mb-3">
            <div><small class="text-muted">Toplam √ñdeme:</small><h3 class="fw-bold text-danger mb-0" id="totalPrice">0 TL</h3></div>
            <button class="btn btn-sm text-muted" onclick="temizle()">Sƒ±fƒ±rla</button>
        </div>
        <div class="row g-2">
            <div class="col-4"><button onclick="garsonCagir()" class="btn btn-warning w-100 py-3 rounded-4 fw-bold">üõéÔ∏è Garson</button></div>
            <div class="col-8"><button onclick="wpGonder()" class="btn btn-success w-100 py-3 rounded-4 fw-bold">üü¢ WHATSAPP Sƒ∞PARƒ∞≈û</button></div>
        </div>
    </div>

    <script>
        let sepet = [];
        let numara = "905464744594"; // BURAYA KENDƒ∞ NUMARANI YAZ

        function sepeteEkle(ad, fiyat, oneri) {
            let p = parseInt(fiyat.replace(/[^0-9]/g, ''));
            sepet.push({ad, p});
            if(oneri && oneri !== 'None') {
                let toast = document.getElementById('suggestionToast');
                document.getElementById('suggestionText').innerHTML = `üí° <b>√ñneri:</b> ${ad} yanƒ±na <u>${oneri}</u> harika gider!`;
                toast.style.display = 'block';
                setTimeout(() => { toast.style.display = 'none'; }, 4000);
            }
            guncelle();
        }

        function guncelle() {
            document.getElementById('orderBar').style.display = sepet.length > 0 ? 'block' : 'none';
            document.getElementById('totalPrice').innerText = sepet.reduce((a, b) => a + b.p, 0) + " TL";
        }

        function wpGonder() {
            let m = document.getElementById('masaNo').value;
            if(m === "Bilinmiyor") { alert("√ñnce masa se√ß kanka!"); return; }
            let msg = `*‚ö° ≈ûƒ∞M≈ûEK ASPAVA MAX Sƒ∞PARƒ∞≈û*\nüìç MASA: ${m}\n‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n`;
            sepet.forEach(item => msg += `‚Ä¢ ${item.ad}\n`);
            let n = document.getElementById('siparisNotu').value;
            if(n) msg += `\nüìù NOT: ${n}\n`;
            msg += `‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\nüí∞ TOPLAM: *${document.getElementById('totalPrice').innerText}*`;
            window.open(`https://wa.me/${numara}?text=${encodeURIComponent(msg)}`);
        }

        function garsonCagir() {
    let m = document.getElementById('masaNo').value;
    
    // Masa se√ßimi kontrol√º (Piyasadaki en g√ºvenli kontrol)
    if(m === "Bilinmiyor" || m === "" || m === null) { 
        alert("√ñnce masanƒ± se√ß kanka, garson nereye geleceƒüini bilsin! üòä"); 
        return; 
    }
    
    // Mesaj i√ßeriƒüini hazƒ±rlƒ±yoruz
    let mesajMetni = `*üõéÔ∏è GARSON √áAƒûRISI*\nüìç MASA: ${m}\nM√º≈üteri masada seni bekliyor ≈üefim!`;
    
    // 404 hatasƒ±nƒ± engelleyen doƒüru URL yapƒ±sƒ±
    let wpUrl = `https://wa.me/${numara}?text=${encodeURIComponent(mesajMetni)}`;
    
    window.open(wpUrl, '_blank');
}
        

        function filtrele(id, btn) {
            document.querySelectorAll('.filter-btn').forEach(b => b.classList.remove('active'));
            btn.classList.add('active');
            document.querySelectorAll('.category-section').forEach(s => s.style.display = (id === 'hepsi' || s.id === 'cat-' + id) ? 'block' : 'none');
        }

        function arama() {
            let val = document.getElementById('searchInput').value.toLowerCase();
            document.querySelectorAll('.menu-card').forEach(c => c.style.display = c.getAttribute('data-name').includes(val) ? 'flex' : 'none');
        }

        function temizle() { sepet = []; guncelle(); }
    </script>
</body>
</html>